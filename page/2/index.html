<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>无名小站 | 欢迎来到这里！</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="博客">
    <meta name="description" content="随便记录点东西">
<meta name="keywords" content="博客">
<meta property="og:type" content="website">
<meta property="og:title" content="无名小站">
<meta property="og:url" content="http://blog.yanximin.site/page/2/index.html">
<meta property="og:site_name" content="无名小站">
<meta property="og:description" content="随便记录点东西">
<meta property="og:locale" content="zh-cn">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="无名小站">
<meta name="twitter:description" content="随便记录点东西">
    
        <link rel="alternate" type="application/atom+xml" title="无名小站" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.6.10">
    <script>window.lazyScripts=[]</script>
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu"  >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Yan Ximin</h5>
          <a href="mailto:yanximin@foxmail.com" title="yanximin@foxmail.com" class="mail">yanximin@foxmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                归档
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/yAnXImIN" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://weibo.com/u/2716758684" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                我的微博
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">无名小站</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="global.search_input_hint">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header index-header">

    <div class="container fade-scale">
        <h1 class="title">无名小站</h1>
        <h5 class="subtitle">
            
                欢迎来到这里！
            
        </h5>
    </div>

    


</header>

<div class="container body-wrap">

    <ul class="post-list">
    
        <li class="post-list-item fade">
            <article id="post-database-recovery"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2017-09-05 04:51:50" datetime="2017-09-04T20:51:50.000Z"  itemprop="datePublished">2017-09-05</time>

        


    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/2017/09/05/database-recovery/">MySql数据库恢复</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>今天网站出现了数据丢失的问题, 主要原因在于网络不稳定导致.</p>
<p>辛亏之前每天都有在每天晚上十二点备份数据库. 恢复数据库的方法很简单.</p>
<p>找到相应的数据库备份文件, 比如<code>backupfile.sql.gz</code></p>
<p>在shell中输入以下命令<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gunzip &lt; backupfile.sql.gz | mysql -u username -p password databasename</span><br></pre></td></tr></table></figure></p>
<p>其中<code>gunzip</code>用来解压这个文件,然后使用管道传输到MySql中.</p>

    

        <a href="/2017/09/05/database-recovery/" class="post-more waves-effect waves-button">
            post.continue_reading
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网站维护/">网站维护</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-four-post"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2017-09-04 05:09:21" datetime="2017-09-03T21:09:21.000Z"  itemprop="datePublished">2017-09-04</time>

        


    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/2017/09/04/four-post/">四种POST方式的比较</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <blockquote>
<p>转载自<a href="http://www.cnblogs.com/aaronjs/p/4165049.html" target="_blank" rel="noopener">http://www.cnblogs.com/aaronjs/p/4165049.html</a></p>
</blockquote>
<p>HTTP/1.1 协议规定的 HTTP 请求方法有 OPTIONS、GET、HEAD、POST、PUT、DELETE、TRACE、CONNECT 这几种。其中 POST 一般用来向服务端提交数据，本文主要讨论 POST 提交数据的几种方式。</p>
<p>我们知道，HTTP 协议是以 ASCII 码传输，建立在 TCP/IP 协议之上的应用层规范。规范把 HTTP 请求分为三个部分：状态行、请求头、消息主体。类似于下面这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;method&gt; &lt;request-url&gt; &lt;version&gt;</span><br><span class="line">&lt;headers&gt;</span><br><span class="line">&lt;entity-body&gt;</span><br></pre></td></tr></table></figure></p>
<p>协议规定 POST 提交的数据必须放在消息主体（entity-body）中，但协议并没有规定数据必须使用什么编码方式。实际上，开发者完全可以自己决定消息主体的格式，只要最后发送的 HTTP 请求满足上面的格式就可以。</p>
<p>但是，数据发送出去，还要服务端解析成功才有意义。一般服务端语言如 php、python 等，以及它们的 framework，都内置了自动解析常见数据格式的功能。服务端通常是根据请求头（headers）中的 Content-Type 字段来获知请求中的消息主体是用何种方式编码，再对主体进行解析。所以说到 POST 提交数据方案，包含了 Content-Type 和消息主体编码方式两部分。下面就正式开始介绍它们。</p>
<h2 id="application-x-www-form-urlencoded"><a href="#application-x-www-form-urlencoded" class="headerlink" title="application/x-www-form-urlencoded"></a>application/x-www-form-urlencoded</h2><p>这应该是最常见的 POST 提交数据的方式了。浏览器的原生 form 表单，如果不设置 enctype 属性，那么最终就会以 application/x-www-form-urlencoded 方式提交数据。请求类似于下面这样（无关的请求头在本文中都省略掉了）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST http://www.example.com HTTP/1.1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded;charset=utf-8</span><br><span class="line">title=test&amp;sub%5B%5D=1&amp;sub%5B%5D=2&amp;sub%5B%5D=3</span><br></pre></td></tr></table></figure>
<p>首先，Content-Type 被指定为 application/x-www-form-urlencoded；其次，提交的数据按照 key1=val1&amp;key2=val2 的方式进行编码，key 和 val 都进行了 URL 转码。大部分服务端语言都对这种方式有很好的支持。例如 PHP 中，<code>_POST[&#39;title&#39;]</code> 可以获取到<code>title</code>的值, <code>_POST[&#39;sub&#39;]</code> 可以得到 <code>sub</code> 数组。</p>
<p>很多时候，我们用 Ajax 提交数据时，也是使用这种方式。例如 <code>JQuery</code> 和 <code>QWrap</code> 的 Ajax，<code>Content-Type</code> 默认值都是<code>application/x-www-form-urlencoded;charset=utf-8</code>。</p>
<h2 id="multipart-form-data"><a href="#multipart-form-data" class="headerlink" title="multipart/form-data"></a>multipart/form-data</h2><p>这又是一个常见的 POST 数据提交的方式。我们使用表单上传文件时，必须让 form 的 enctyped 等于这个值。直接来看一个请求示例：<code>POST ttp://www.example.com HTTP/1.1</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Content-Type:multipart/form-data; boundary=----WebKitFormBoundaryrGKCBY7qhFd3TrwA</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryrGKCBY7qhFd3TrwA</span><br><span class="line"></span><br><span class="line">Content-Disposition: form-data; name=&quot;text&quot;</span><br><span class="line"></span><br><span class="line">title</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryrGKCBY7qhFd3TrwA</span><br><span class="line"></span><br><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;chrome.png&quot;</span><br><span class="line"></span><br><span class="line">Content-Type: image/png</span><br><span class="line"></span><br><span class="line">PNG ... content of chrome.png ...</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryrGKCBY7qhFd3TrwA--</span><br></pre></td></tr></table></figure>
<p>这个例子稍微复杂点。首先生成了一个 boundary 用于分割不同的字段，为了避免与正文内容重复，boundary 很长很复杂。然后 Content-Type 里指明了数据是以 mutipart/form-data 来编码，本次请求的 boundary 是什么内容。消息主体里按照字段个数又分为多个结构类似的部分，每部分都是以 –boundary 开始，紧接着内容描述信息，然后是回车，最后是字段具体内容（文本或二进制）。如果传输的是文件，还要包含文件名和文件类型信息。消息主体最后以 –boundary– 标示结束。关于 mutipart/form-data 的详细定义，请前往 rfc1867 查看。</p>
<p>这种方式一般用来上传文件，各大服务端语言对它也有着良好的支持。</p>
<p>上面提到的这两种 POST 数据的方式，都是浏览器原生支持的，而且现阶段原生 form 表单也只支持这两种方式。但是随着越来越多的 Web 站点，尤其是 WebApp，全部使用 Ajax 进行数据交互之后，我们完全可以定义新的数据提交方式，给开发带来更多便利。</p>
<h2 id="application-json"><a href="#application-json" class="headerlink" title="application/json"></a>application/json</h2><p>application/json 这个 Content-Type 作为响应头大家肯定不陌生。实际上，现在越来越多的人把它作为请求头，用来告诉服务端消息主体是序列化后的 JSON 字符串。由于 JSON 规范的流行，除了低版本 IE 之外的各大浏览器都原生支持 JSON.stringify，服务端语言也都有处理 JSON 的函数，使用 JSON 不会遇上什么麻烦。</p>
<p>JSON 格式支持比键值对复杂得多的结构化数据，这一点也很有用。记得我几年前做一个项目时，需要提交的数据层次非常深，我就是把数据 JSON 序列化之后来提交的。不过当时我是把 JSON 字符串作为 val，仍然放在键值对里，以 x-www-form-urlencoded 方式提交。</p>
<p>Google 的 AngularJS 中的 Ajax 功能，默认就是提交 JSON 字符串。例如下面这段代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = &#123;<span class="string">'title'</span>:<span class="string">'test'</span>, <span class="string">'sub'</span> : [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]&#125;;</span><br><span class="line"></span><br><span class="line">$http.post(url, data).success(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>最终发送的请求是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">POST http://www.example.com HTTP/1.1</span><br><span class="line"></span><br><span class="line">Content-Type: application/json;charset=utf-8</span><br><span class="line"></span><br><span class="line">&#123;&quot;title&quot;:&quot;test&quot;,&quot;sub&quot;:[1,2,3]&#125;</span><br></pre></td></tr></table></figure>
<p>这种方案，可以方便的提交复杂的结构化数据，特别适合 RESTful 的接口。各大抓包工具如 Chrome 自带的开发者工具、Firebug、Fiddler，都会以树形结构展示 JSON 数据，非常友好。但也有些服务端语言还没有支持这种方式，例如 php 就无法通过 <code>$_POST</code> 对象从上面的请求中获得内容。这时候，需要自己动手处理下：在请求头中 <code>Content-Type</code> 为 <code>application/json</code> 时，从 php://input 里获得原始输入流，再 <code>json_decode</code> 成对象。一些 php 框架已经开始这么做了。</p>
<p>当然 AngularJS 也可以配置为使用 x-www-form-urlencoded 方式提交数据。如有需要，可以参考这篇文章(<a href="http://victorblog.com/2012/12/20/make-angularjs-http-service-behave-like-jquery-ajax/)。" target="_blank" rel="noopener">http://victorblog.com/2012/12/20/make-angularjs-http-service-behave-like-jquery-ajax/)。</a></p>
<h2 id="text-xml"><a href="#text-xml" class="headerlink" title="text/xml"></a>text/xml</h2><p>它是一种使用 HTTP 作为传输协议，XML 作为编码方式的远程调用规范。典型的 XML-RPC 请求是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">POST http://www.example.com HTTP/1.1</span><br><span class="line"></span><br><span class="line">Content-Type: text/xml</span><br><span class="line"></span><br><span class="line">&lt;!--?xml version=&quot;1.0&quot;?--&gt;</span><br><span class="line"></span><br><span class="line">&lt;methodcall&gt;</span><br><span class="line"></span><br><span class="line">&lt;methodname&gt;examples.getStateName&lt;/methodname&gt;</span><br><span class="line"></span><br><span class="line">&lt;params&gt;</span><br><span class="line"></span><br><span class="line">&lt;param&gt;</span><br><span class="line"></span><br><span class="line">&lt;value&gt;&lt;i4&gt;41&lt;/i4&gt;&lt;/value&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/params&gt;</span><br><span class="line"></span><br><span class="line">&lt;/methodcall&gt;</span><br></pre></td></tr></table></figure>
<p>XML-RPC 协议简单、功能够用，各种语言的实现都有。它的使用也很广泛，如 WordPress 的 XML-RPC Api，搜索引擎的 ping 服务等等。JavaScript 中，也有现成的库支持以这种方式进行数据交互，能很好的支持已有的 XML-RPC 服务。不过，我个人觉得 XML 结构还是过于臃肿，一般场景用 JSON 会更灵活方便。</p>

    

        <a href="/2017/09/04/four-post/" class="post-more waves-effect waves-button">
            post.continue_reading
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-java-download"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2017-09-04 04:51:12" datetime="2017-09-03T20:51:12.000Z"  itemprop="datePublished">2017-09-04</time>

        


    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/2017/09/04/java-download/">使用Java下载大文件</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>主要思路是将大文件分解成若干个小文件进行下载.</p>
<p>本功能由两个类实现:<code>DownLoadManager</code>和<code>DownloadThreadTask</code>实现. 其中<code>DownLoadManager</code>类主要负责下载任务的初始化和调度, <code>DownloadThreadTask</code>主要负责处理下载任务.  </p>
<p>用到的主要工具类有  </p>
<ol>
<li><p>org.apache.http.impl.client.CloseableHttpClient  模拟httpClient客户端发送http请求，可以控制到请求文件的字节位置。</p>
</li>
<li><p>BufferedInputStream都熟悉，用它接受请求来的流信息缓存。</p>
</li>
<li><p>RandomAccessFile文件随机类，可以向文件写入指定位置的流信息。</p>
</li>
</ol>
<p>代码如下:</p>
<p><code>DownLoadManager</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.RandomAccessFile;</span><br><span class="line"><span class="keyword">import</span> java.net.HttpURLConnection;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.CountDownLatch;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang.exception.ExceptionUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.CloseableHttpClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.HttpClients;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.conn.PoolingHttpClientConnectionManager;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 文件下载管理类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DownLoadManager</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(DownLoadManager.class);</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 每个线程下载的字节数</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> unitSize = <span class="number">1000</span> * <span class="number">1024</span>;</span><br><span class="line">	<span class="keyword">private</span> ExecutorService taskExecutor = Executors.newFixedThreadPool(<span class="number">10</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> CloseableHttpClient httpClient;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">DownLoadManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		PoolingHttpClientConnectionManager cm = <span class="keyword">new</span> PoolingHttpClientConnectionManager();</span><br><span class="line">		cm.setMaxTotal(<span class="number">100</span>);</span><br><span class="line">		httpClient = HttpClients.custom().setConnectionManager(cm).build();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="keyword">new</span> DownLoadManager().doDownload();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 启动多个线程下载文件</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doDownload</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="comment">//要下载的url</span></span><br><span class="line">		String remoteFileUrl = <span class="string">"http://cn-sdjn-cu-v-04.acgvideo.com/vg4/e/60/21029304-1.mp4?expires=1504513500&amp;platform=pc&amp;ssig=4-pYfuQHUKppz3XGrw6Hnw&amp;oi=1032322900&amp;nfa=T7l/1XWXSxfil4KoioiGpQ==&amp;dynamic=1&amp;hfa=2073962963&amp;hfb=Yjk5ZmZjM2M1YzY4ZjAwYTMzMTIzYmIyNWY4ODJkNWI="</span>;</span><br><span class="line">		String localPath = <span class="string">"E://temp//"</span>;</span><br><span class="line">		String fileName = <span class="keyword">new</span> URL(remoteFileUrl).getFile();</span><br><span class="line">		System.out.println(<span class="string">"远程文件名称："</span> + fileName);</span><br><span class="line">		fileName = fileName.substring(fileName.lastIndexOf(<span class="string">"/"</span>) + <span class="number">1</span>, fileName.length()).replace(<span class="string">"%20"</span>, <span class="string">" "</span>);</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"本地文件名称："</span> + fileName);</span><br><span class="line">		<span class="keyword">long</span> fileSize = <span class="keyword">this</span>.getRemoteFileSize(remoteFileUrl);</span><br><span class="line">		<span class="keyword">this</span>.createFile(localPath + System.currentTimeMillis() + fileName, fileSize);</span><br><span class="line">		Long threadCount = (fileSize / unitSize) + (fileSize % unitSize != <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">		<span class="keyword">long</span> offset = <span class="number">0</span>;</span><br><span class="line">		</span><br><span class="line">		CountDownLatch end = <span class="keyword">new</span> CountDownLatch(threadCount.intValue());</span><br><span class="line">		<span class="keyword">if</span> (fileSize &lt;= unitSize) &#123;<span class="comment">// 如果远程文件尺寸小于等于unitSize</span></span><br><span class="line">			DownloadThreadTask downloadThread = <span class="keyword">new</span> DownloadThreadTask(remoteFileUrl, localPath + fileName, offset, fileSize, end, httpClient);</span><br><span class="line">			taskExecutor.execute(downloadThread);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;<span class="comment">// 如果远程文件尺寸大于unitSize</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; threadCount; i++) &#123;</span><br><span class="line">				DownloadThreadTask downloadThread = <span class="keyword">new</span> DownloadThreadTask(remoteFileUrl, localPath + fileName, offset, unitSize, end, httpClient);</span><br><span class="line">				taskExecutor.execute(downloadThread);</span><br><span class="line">				offset = offset + unitSize;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (fileSize % unitSize != <span class="number">0</span>) &#123;<span class="comment">// 如果不能整除，则需要再创建一个线程下载剩余字节</span></span><br><span class="line">				DownloadThreadTask downloadThread = <span class="keyword">new</span> DownloadThreadTask(remoteFileUrl, localPath + fileName, offset, fileSize - unitSize * (threadCount - <span class="number">1</span>), end, httpClient);</span><br><span class="line">				taskExecutor.execute(downloadThread);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			end.await();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">			LOGGER.error(<span class="string">"DownLoadManager exception msg:&#123;&#125;"</span>, ExceptionUtils.getFullStackTrace(e));</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		taskExecutor.shutdown();</span><br><span class="line">		LOGGER.debug(<span class="string">"下载完成！&#123;&#125; "</span>, localPath + fileName);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 获取远程文件尺寸</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">getRemoteFileSize</span><span class="params">(String remoteFileUrl)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="keyword">long</span> fileSize = <span class="number">0</span>;</span><br><span class="line">		HttpURLConnection httpConnection = (HttpURLConnection) <span class="keyword">new</span> URL(remoteFileUrl).openConnection();</span><br><span class="line">		<span class="comment">//使用HEAD方法</span></span><br><span class="line">		httpConnection.setRequestMethod(<span class="string">"HEAD"</span>);</span><br><span class="line">		<span class="keyword">int</span> responseCode = httpConnection.getResponseCode();</span><br><span class="line">		<span class="keyword">if</span> (responseCode &gt;= <span class="number">400</span>) &#123;</span><br><span class="line">			LOGGER.debug(<span class="string">"Web服务器响应错误!"</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		String sHeader;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>;; i++) &#123;</span><br><span class="line">			sHeader = httpConnection.getHeaderFieldKey(i);</span><br><span class="line">			<span class="keyword">if</span> (sHeader != <span class="keyword">null</span> &amp;&amp; sHeader.equals(<span class="string">"Content-Length"</span>)) &#123;</span><br><span class="line">				System.out.println(<span class="string">"文件大小ContentLength:"</span> + httpConnection.getContentLength());</span><br><span class="line">				fileSize = Long.parseLong(httpConnection.getHeaderField(sHeader));</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> fileSize;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 创建指定大小的文件</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">createFile</span><span class="params">(String fileName, <span class="keyword">long</span> fileSize)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		File newFile = <span class="keyword">new</span> File(fileName);</span><br><span class="line">		RandomAccessFile raf = <span class="keyword">new</span> RandomAccessFile(newFile, <span class="string">"rw"</span>);</span><br><span class="line">		raf.setLength(fileSize);</span><br><span class="line">		raf.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>DownloadThreadTask</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.RandomAccessFile;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.CountDownLatch;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang.exception.ExceptionUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.ClientProtocolException;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.CloseableHttpResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.HttpGet;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.CloseableHttpClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.protocol.BasicHttpContext;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.protocol.HttpContext;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 负责文件下载的类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DownloadThreadTask</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(DownloadThreadTask.class);</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 待下载的文件</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> String url = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 本地文件名</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> String fileName = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 偏移量</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> offset = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 分配给本线程的下载字节数</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">long</span> length = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> CountDownLatch end;</span><br><span class="line">	<span class="keyword">private</span> CloseableHttpClient httpClient;</span><br><span class="line">	<span class="keyword">private</span> HttpContext context;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> url</span></span><br><span class="line"><span class="comment">	 *            下载文件地址</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> fileName</span></span><br><span class="line"><span class="comment">	 *            另存文件名</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> offset</span></span><br><span class="line"><span class="comment">	 *            本线程下载偏移量</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> length</span></span><br><span class="line"><span class="comment">	 *            本线程下载长度</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">DownloadThreadTask</span><span class="params">(String url, String file, <span class="keyword">long</span> offset, <span class="keyword">long</span> length, CountDownLatch end, CloseableHttpClient httpClient)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.url = url;</span><br><span class="line">		<span class="keyword">this</span>.fileName = file;</span><br><span class="line">		<span class="keyword">this</span>.offset = offset;</span><br><span class="line">		<span class="keyword">this</span>.length = length;</span><br><span class="line">		<span class="keyword">this</span>.end = end;</span><br><span class="line">		<span class="keyword">this</span>.httpClient = httpClient;</span><br><span class="line">		<span class="keyword">this</span>.context = <span class="keyword">new</span> BasicHttpContext();</span><br><span class="line">		LOGGER.debug(<span class="string">"偏移量="</span> + offset + <span class="string">";字节数="</span> + length);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			HttpGet httpGet = <span class="keyword">new</span> HttpGet(<span class="keyword">this</span>.url);</span><br><span class="line">			httpGet.addHeader(<span class="string">"Range"</span>, <span class="string">"bytes="</span> + <span class="keyword">this</span>.offset + <span class="string">"-"</span> + (<span class="keyword">this</span>.offset + <span class="keyword">this</span>.length - <span class="number">1</span>));</span><br><span class="line">			httpGet.addHeader(<span class="string">"Referer"</span>, <span class="string">"http://api.bilibili.com"</span>);</span><br><span class="line">			CloseableHttpResponse response = httpClient.execute(httpGet, context);</span><br><span class="line">			BufferedInputStream bis = <span class="keyword">new</span> BufferedInputStream(response.getEntity().getContent());</span><br><span class="line">			<span class="keyword">byte</span>[] buff = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">			<span class="keyword">int</span> bytesRead;</span><br><span class="line">			File newFile = <span class="keyword">new</span> File(fileName);</span><br><span class="line">			RandomAccessFile raf = <span class="keyword">new</span> RandomAccessFile(newFile, <span class="string">"rw"</span>);</span><br><span class="line">			<span class="keyword">while</span> ((bytesRead = bis.read(buff, <span class="number">0</span>, buff.length)) != -<span class="number">1</span>) &#123;</span><br><span class="line">				raf.seek(<span class="keyword">this</span>.offset);</span><br><span class="line">				raf.write(buff, <span class="number">0</span>, bytesRead);</span><br><span class="line">				<span class="keyword">this</span>.offset = <span class="keyword">this</span>.offset + bytesRead;</span><br><span class="line">			&#125;</span><br><span class="line">			raf.close();</span><br><span class="line">			bis.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClientProtocolException e) &#123;</span><br><span class="line">			LOGGER.error(<span class="string">"DownloadThread exception msg:&#123;&#125;"</span>, ExceptionUtils.getFullStackTrace(e));</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			LOGGER.error(<span class="string">"DownloadThread exception msg:&#123;&#125;"</span>, ExceptionUtils.getFullStackTrace(e));</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			end.countDown();</span><br><span class="line">			LOGGER.info(end.getCount() + <span class="string">" is go on!"</span>);</span><br><span class="line">			System.out.println(end.getCount() + <span class="string">" is go on!"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

    

        <a href="/2017/09/04/java-download/" class="post-more waves-effect waves-button">
            post.continue_reading
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-interview"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2017-08-13 05:10:11" datetime="2017-08-12T21:10:11.000Z"  itemprop="datePublished">2017-08-13</time>

        


    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/2017/08/13/interview/">面试记录</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h1 id="面试记录"><a href="#面试记录" class="headerlink" title="面试记录"></a>面试记录</h1><h2 id="2017-8-14-百度-百度运维团队"><a href="#2017-8-14-百度-百度运维团队" class="headerlink" title="2017.8.14 百度 百度运维团队"></a>2017.8.14 百度 百度运维团队</h2><p>面试的地点在百度科技园K2一楼大厅里。里面都是面试的，不知道是不是为同一个部门。面试官好像不是搞Java的，面的问题中没有包含任何Java的内容而且不清楚SSH框架。<br>主要问了一下项目的事情：  </p>
<ol>
<li>EM999中的架构，数据库设计，功能设计等等。询问了具体实现细节，系统是否包含自学习功能等。  </li>
<li>在网易实习的情况，爬虫的架构和性能等。 </li>
</ol>
<p>介绍完上面的内容之后差不多过了一个半小时。 </p>
<p>最后问了一道编程题。</p>
<blockquote>
<p>一个人上台阶，一次可以走1步或者2步，问走到第n个台阶有多少种走法。  </p>
</blockquote>
<p>这是Leetcode和牛客网上的一道原题，用斐波那契数列就可以解决。</p>
<p>总结：面试官可能没搞过Java或者没接触过Java的一些框架，如何使他们快速地了解这些框架的特性，继而清楚我们所做系统的内容和价值。</p>

    

        <a href="/2017/08/13/interview/" class="post-more waves-effect waves-button">
            post.continue_reading
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/面试/">面试</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-java-nio"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2017-08-08 07:05:48" datetime="2017-08-07T23:05:48.000Z"  itemprop="datePublished">2017-08-08</time>

        


    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/2017/08/08/java-nio/">Java nio</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <blockquote>
<p>转载自<a href="http://ifeve.com/overview/" target="_blank" rel="noopener">http://ifeve.com/overview/</a><br>原始英文地址: <a href="http://tutorials.jenkov.com/java-nio/overview.html" target="_blank" rel="noopener">http://tutorials.jenkov.com/java-nio/overview.html</a></p>
</blockquote>
<p>Java NIO 由以下几个核心部分组成：</p>
<ul>
<li>Channels</li>
<li>Buffers</li>
<li>Selectors<br>虽然Java NIO 中除此之外还有很多类和组件，但在我看来，Channel，Buffer 和 Selector 构成了核心的API。其它组件，如Pipe和FileLock，只不过是与三个核心组件共同使用的工具类。因此，在概述中我将集中在这三个组件上。其它组件会在单独的章节中讲到。</li>
</ul>
<h2 id="Channel-和-Buffer"><a href="#Channel-和-Buffer" class="headerlink" title="Channel 和 Buffer"></a>Channel 和 Buffer</h2><p>基本上，所有的 IO 在NIO 中都从一个Channel 开始。Channel 有点象流。 数据可以从Channel读到Buffer中，也可以从Buffer 写到Channel中。这里有个图示：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://ifeve.com/wp-content/uploads/2013/06/overview-channels-buffers1.png" alt="Channel和Buffer" title="">
                </div>
                <div class="image-caption">Channel和Buffer</div>
            </figure><br>Channel和Buffer有好几种类型。下面是JAVA NIO中的一些主要Channel的实现：</p>
<ul>
<li>FileChannel</li>
<li>DatagramChannel</li>
<li>SocketChannel</li>
<li>ServerSocketChannel</li>
</ul>
<p>正如你所看到的，这些通道涵盖了UDP 和 TCP 网络IO，以及文件IO。</p>
<p>与这些类一起的有一些有趣的接口，但为简单起见，我尽量在概述中不提到它们。本教程其它章节与它们相关的地方我会进行解释。</p>
<p>以下是Java NIO里关键的Buffer实现：</p>
<ul>
<li>ByteBuffer</li>
<li>CharBuffer</li>
<li>DoubleBuffer</li>
<li>FloatBuffer</li>
<li>IntBuffer</li>
<li>LongBuffer</li>
<li>ShortBuffer<br>这些Buffer覆盖了你能通过IO发送的基本数据类型：byte, short, int, long, float, double 和 char。</li>
</ul>
<p>Java NIO 还有个 MappedByteBuffer，用于表示内存映射文件， 我也不打算在概述中说明。</p>
<h2 id="Selector"><a href="#Selector" class="headerlink" title="Selector"></a>Selector</h2><p>Selector允许单线程处理多个 Channel。如果你的应用打开了多个连接（通道），但每个连接的流量都很低，使用Selector就会很方便。例如，在一个聊天服务器中。</p>
<p>这是在一个单线程中使用一个Selector处理3个Channel的图示：<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://ifeve.com/wp-content/uploads/2013/06/overview-selectors.png" alt="Selector和Channel" title="">
                </div>
                <div class="image-caption">Selector和Channel</div>
            </figure> </p>
<p>下面是NIO的一些代码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testNio</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">	<span class="comment">// 打开文件</span></span><br><span class="line">	RandomAccessFile file = <span class="keyword">new</span> RandomAccessFile(<span class="string">"data/uid.txt"</span>, <span class="string">"rw"</span>);</span><br><span class="line">	<span class="comment">// 获取Channel</span></span><br><span class="line">	FileChannel channel = file.getChannel();</span><br><span class="line">	<span class="comment">// 得到一个大小为48的Buffer</span></span><br><span class="line">	ByteBuffer byteBuffer = ByteBuffer.allocate(<span class="number">48</span>);</span><br><span class="line">	<span class="comment">// Channel开始向Buffer添加数据, byteCount返回的为byteBuffer真实读取到的大小,此时 postion =</span></span><br><span class="line">	<span class="comment">// byteCount</span></span><br><span class="line">	<span class="keyword">int</span> byteCount = channel.read(byteBuffer);</span><br><span class="line">	<span class="keyword">while</span> (byteCount != -<span class="number">1</span>) &#123;</span><br><span class="line">		System.out.println(<span class="string">"read:"</span> + byteCount);</span><br><span class="line">		<span class="comment">// buffer 启动写模式 limit=position, position=0,</span></span><br><span class="line">		<span class="comment">// buffer只能从postion~limit(不包含limit)之间读取数据</span></span><br><span class="line">		byteBuffer.flip();</span><br><span class="line">		<span class="comment">// hasRemaining()方法判断position&lt;limit</span></span><br><span class="line">		<span class="keyword">while</span> (byteBuffer.hasRemaining()) &#123;</span><br><span class="line">			<span class="comment">// get()方法返回position所对应的值,position++;</span></span><br><span class="line">			System.out.println((<span class="keyword">char</span>) byteBuffer.get());</span><br><span class="line">		&#125;</span><br><span class="line">		byteBuffer.clear();</span><br><span class="line">		byteCount = channel.read(byteBuffer);</span><br><span class="line">	&#125;</span><br><span class="line">	file.close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testTransfer</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">	<span class="comment">// fromChannel打开fromFile.txt</span></span><br><span class="line">	RandomAccessFile fromFile = <span class="keyword">new</span> RandomAccessFile(<span class="string">"fromFile.txt"</span>, <span class="string">"rw"</span>);</span><br><span class="line">	FileChannel fromChannel = fromFile.getChannel();</span><br><span class="line">	<span class="comment">// toChannel打开toFile.txt</span></span><br><span class="line">	RandomAccessFile toFile = <span class="keyword">new</span> RandomAccessFile(<span class="string">"toFile.txt"</span>, <span class="string">"rw"</span>);</span><br><span class="line">	FileChannel toChannel = toFile.getChannel();</span><br><span class="line">	<span class="keyword">long</span> position = <span class="number">0</span>;</span><br><span class="line">	<span class="comment">//Returns the current size of this channel's file.</span></span><br><span class="line">	<span class="keyword">long</span> count = fromChannel.size();</span><br><span class="line">	<span class="comment">// 開始Channel之間的轉化</span></span><br><span class="line">	toChannel.transferFrom(fromChannel, position, count);</span><br><span class="line">	fromFile.close();</span><br><span class="line">	toFile.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="ifeve-NIO系列教程地址"><a href="#ifeve-NIO系列教程地址" class="headerlink" title="ifeve  NIO系列教程地址"></a>ifeve  NIO系列教程地址</h2><p><a href="http://ifeve.com/overview/" target="_blank" rel="noopener">Java NIO系列教程（一） Java NIO 概述</a><br><a href="http://ifeve.com/channels/" target="_blank" rel="noopener">Java NIO系列教程（二） Channel</a><br><a href="http://ifeve.com/buffers/" target="_blank" rel="noopener">Java NIO系列教程（三） Buffer</a><br><a href="http://ifeve.com/java-nio-scattergather/" target="_blank" rel="noopener">Java NIO系列教程（四） Scatter/Gather</a><br><a href="http://ifeve.com/java-nio-channel-to-channel/" target="_blank" rel="noopener">Java NIO系列教程（五） 通道之间的数据传输</a><br><a href="http://ifeve.com/selectors/" target="_blank" rel="noopener">Java NIO系列教程（六） Selector</a><br><a href="http://ifeve.com/file-channel/" target="_blank" rel="noopener">Java NIO系列教程（七） FileChannel</a><br><a href="http://ifeve.com/socket-channel/" target="_blank" rel="noopener">Java NIO系列教程（八） SocketChannel</a><br><a href="http://ifeve.com/server-socket-channel/" target="_blank" rel="noopener">Java NIO系列教程（九） ServerSocketChannel</a><br><a href="http://ifeve.com/datagram-channel/" target="_blank" rel="noopener">Java NIO系列教程（十） Java NIO DatagramChannel</a><br><a href="http://ifeve.com/pipe/" target="_blank" rel="noopener">Java NIO系列教程（十一） Pipe</a><br><a href="http://ifeve.com/java-nio-vs-io/" target="_blank" rel="noopener">Java NIO系列教程（十二） Java NIO与IO</a>  </p>

    

        <a href="/2017/08/08/java-nio/" class="post-more waves-effect waves-button">
            post.continue_reading
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-reflect-1"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2017-08-04 08:29:02" datetime="2017-08-04T00:29:02.000Z"  itemprop="datePublished">2017-08-04</time>

        


    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/2017/08/04/reflect-1/">Java 反射机制初探</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h2 id="Java-反射机制"><a href="#Java-反射机制" class="headerlink" title="Java 反射机制"></a>Java 反射机制</h2><p>反射(Reflect)是Java语言中的重要的特性. Java框架中的绝大多数都使用了反射. 理解框架必须要精通反射的实现和原理. 在<code>java.lang.reflect</code>中, Java提供了一些列反射的类. 其中, 最常用的几个类分别为<code>Class</code>(这个类在<code>java.lang</code>包下), <code>Method</code>, <code>Field</code>, <code>Constructor</code>. 从字面意思上来看, 上面几个类分别对应了Java语言中的类, 方法, 字段, 构造方法. 通过学习使用这几个类, 可以让我们了解Java反射的过程和使用.  </p>
<h3 id="Class"><a href="#Class" class="headerlink" title="Class"></a><code>Class</code></h3><p><code>Class</code>在<code>java.lang</code>, 在Java文档中,对<code>Class</code>类的描述如下</p>
<blockquote>
<p>Instances of the class Class represent classes and interfaces in a running Java application. An enum is a kind of class and an annotation is a kind of interface. Every array also belongs to a class that is reflected as a Class object that is shared by all arrays with the same element type and number of dimensions. The primitive Java types (boolean, byte, char, short, int, long, float, and double), and the keyword void are also represented as Class objects.<br>Class has no public constructor. Instead Class objects are constructed automatically by the Java Virtual Machine as classes are loaded and by calls to the defineClass method in the class loader.  </p>
</blockquote>
<p>从上面我们可以看到<code>Class</code>是Java类的对象. 从<code>Class</code>的实例中, 我们可以操纵Java指定的类. 而且<code>Class</code>类没有构造函数, 只能从一些特定途径生成类对象.</p>
<p>下面代码展示了如何获取一个类对象,首先我们声明一个<code>Student</code>类, 该类是一个普通的类. 下面的所有代码不外加说明的话, 都在此类的基础上展开.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> reflect;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> sId;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> sName;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getsId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> sId;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setsId</span><span class="params">(<span class="keyword">int</span> sId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.sId = sId;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getsName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> sName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setsName</span><span class="params">(<span class="keyword">int</span> sName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.sName = sName;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"hello"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">()</span></span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"play"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.sId = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> sname)</span></span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.sId = id;</span><br><span class="line">		<span class="keyword">this</span>.sName = sname;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>使用类全称获取类对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = Class.forName(<span class="string">"reflect.Student"</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用类名获取类对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = Student.class</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用实例获得类对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Student s = <span class="keyword">new</span> Student();</span><br><span class="line">Class clazz = s.getClass();</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>上述三种方式都可以获取<code>Student</code>的<code>Class</code>对象. 目前来说, 第一种使用类名的字符串获取类对象更加常用.</p>
<p>在一个类对象中有一个方法特别值得注意:<code>newInstance()</code>. 这个方法从字面上就可以很好理解: 产生一个该类的实例.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = Class.forName(<span class="string">"reflect.Student"</span>);</span><br><span class="line">Object o = clazz.newInstance();</span><br></pre></td></tr></table></figure></p>
<p>但是这个方法只能调用无参构造函数. 当需要调用带参构造函数时或者类中没有无参构造函数时, 就不能用了. 幸好Java提供了<code>Constructor</code>类去调用其他的构造函数. </p>
<h3 id="Constructor"><a href="#Constructor" class="headerlink" title="Constructor"></a><code>Constructor</code></h3><p><code>Constructor</code>在<code>java.lang.reflect</code>包中. 在Java文档中,对<code>Constructor</code>类的描述如下</p>
<blockquote>
<p>Constructor provides information about, and access to, a single constructor for a class.<br>Constructor permits widening conversions to occur when matching the actual parameters to newInstance() with the underlying constructor’s formal parameters, but throws an IllegalArgumentException if a narrowing conversion would occur.  </p>
</blockquote>
<p>正如上面所说, <code>Constructor</code>是为了解决调用带参构造函数的时候使用, 当然它也可以用来调用无参构造函数. <code>Constructor</code>相当于<code>Class</code>中的<code>newInstance()</code>函数的升级版本.<br>具体用法如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Constructor[] constructors = clazz.getConstructors();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;constructors.length;i++)&#123;</span><br><span class="line">	Method getIdMethod = clazz.getMethod(<span class="string">"getsId"</span>);</span><br><span class="line">	System.out.println(constructors[i].getName()+<span class="string">" "</span>+constructors[i].getParameterCount());</span><br><span class="line">	<span class="keyword">if</span>(constructors[i].getParameterCount()==<span class="number">0</span>)&#123;</span><br><span class="line">		Object o = constructors[i].newInstance();</span><br><span class="line">		System.out.println(getIdMethod.invoke(o));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(constructors[i].getParameterCount()==<span class="number">1</span>)&#123;</span><br><span class="line">		Object o = constructors[i].newInstance(<span class="number">1</span>);</span><br><span class="line">		System.out.println(getIdMethod.invoke(o));</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		Object o = constructors[i].newInstance(<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">		System.out.println(getIdMethod.invoke(o));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Method"><a href="#Method" class="headerlink" title="Method"></a><code>Method</code></h3><p><code>Method</code>在<code>java.lang.reflect</code>包中. 在Java文档中,对<code>Method</code>类的描述如下:</p>
<blockquote>
<p>A Method provides information about, and access to, a single method on a class or interface. The reflected method may be a class method or an instance method (including an abstract method).<br>A Method permits widening conversions to occur when matching the actual parameters to invoke with the underlying method’s formal parameters, but it throws an IllegalArgumentException if a narrowing conversion would occur.</p>
</blockquote>
<p><code>Method</code>类是对Java类方法的抽象. 具体使用方法和示例代码如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Method playMethod = clazz.getMethod(<span class="string">"play"</span>);</span><br><span class="line">playMethod.invoke(clazz.newInstance());		</span><br><span class="line">Method[] allMethod = clazz.getDeclaredMethods();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;allMethod.length;i++)&#123;</span><br><span class="line">	System.out.println(allMethod[i].getName()+<span class="string">" "</span>+allMethod[i].getParameterCount());</span><br><span class="line">&#125;	</span><br><span class="line">Method sayMethod = clazz.getDeclaredMethod(<span class="string">"say"</span>);</span><br><span class="line">sayMethod.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">sayMethod.invoke(clazz.newInstance());</span><br><span class="line">sayMethod.setAccessible(<span class="keyword">false</span>);</span><br></pre></td></tr></table></figure></p>
<p>注意到这句话<code>sayMethod.setAccessible(true)</code>, 目的是让调用者有权限去执行类中的非public方法(或者权限不够的方法).</p>
<h3 id="Field"><a href="#Field" class="headerlink" title="Field"></a><code>Field</code></h3><p><code>Field</code>在<code>java.lang.reflect</code>包中. 在Java文档中,对<code>Field</code>类的描述如下:</p>
<blockquote>
<p>A Field provides information about, and dynamic access to, a single field of a class or an interface. The reflected field may be a class (static) field or an instance field.<br>A Field permits widening conversions to occur during a get or set access operation, but throws an IllegalArgumentException if a narrowing conversion would occur.  </p>
</blockquote>
<p><code>Field</code>类是对Java类字段的抽象. 具体使用方法和示例代码如下<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Field[] fields = clazz.getDeclaredFields();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;fields.length;i++)&#123;</span><br><span class="line">	System.out.println(fields[i].getName());</span><br><span class="line">&#125;	</span><br><span class="line">Object o = clazz.newInstance();</span><br><span class="line">Method m = clazz.getMethod(<span class="string">"setsId"</span>, <span class="keyword">int</span>.class);</span><br><span class="line">System.out.println(m.getName());</span><br><span class="line">m.invoke(o, <span class="number">1</span>);</span><br><span class="line">Field sidField = clazz.getDeclaredField(<span class="string">"sId"</span>);</span><br><span class="line">System.out.println(sidField.getInt(o));</span><br></pre></td></tr></table></figure></p>
<p>以上就是Java反射中的四个比较重要和基础的类. <code>reflect</code>包中还有许多重要的类, 比方说AOP的实现工具<code>InvocationHandler</code>动态代理等等.  理解基本的反射工具可以让我们更好地了解Java语言的特性和Java框架的原理.</p>

    

        <a href="/2017/08/04/reflect-1/" class="post-more waves-effect waves-button">
            post.continue_reading
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-mark-down-for-vscode"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2017-08-01 02:58:53" datetime="2017-07-31T18:58:53.000Z"  itemprop="datePublished">2017-08-01</time>

        


    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/2017/08/01/mark-down-for-vscode/">vscode中使用markdown</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <blockquote>
<p>转载自<a href="http://www.cnblogs.com/rengised/p/6985031.html" target="_blank" rel="noopener">http://www.cnblogs.com/rengised/p/6985031.html</a></p>
</blockquote>
<ul>
<li><strong>vscode</strong> 是微软推出一款轻量级的文本编辑工具，类似于sublime，由于其拥有丰富的插件，安装使用也非常简单，所以深受广大程序员的喜爱。</li>
<li><strong>markdown</strong> 是一种可以使用普通文本编辑器编写的标记语言，通过简单的标记语法，它可以使普通文本内容具有一定的格式。</li>
<li><strong>印象笔记</strong> 是一款具有笔记、写作、日程管理等诸多功能为一体的强大、易用型笔记本，拥有非常丰富的插件，其中比较好用的有<strong>印象笔记·剪藏</strong>，<strong>马克飞象</strong>，具体如何使用，请自行查阅相关资料。</li>
</ul>
<p>markdown有许多衍生产品，本文主要针对大家比较熟知的<strong>印象笔记</strong>为例，说明如何在vscode中使用<em>markdown语法编辑文章，同时将文章同步到印象笔记中</em>。</p>
<h2 id="安装配置步骤："><a href="#安装配置步骤：" class="headerlink" title="安装配置步骤："></a>安装配置步骤：</h2><h3 id="1-准备工作。"><a href="#1-准备工作。" class="headerlink" title="1.准备工作。"></a>1.准备工作。</h3><p>本机已安装vscode、印象笔记或者国际版Evernote，如果没有安装请自行安装以上软件。同时，您已经注册了印象笔记或者国际版Evernote的账号。</p>
<h3 id="2-安装插件。"><a href="#2-安装插件。" class="headerlink" title="2.安装插件。"></a>2.安装插件。</h3><p>在vscode中安装<strong>EverMonkey</strong>，<strong>Auto-Open Markdown Preview</strong>。</p>
<blockquote>
<p>vscode安装插件可以从左侧的工具栏中选择<code>Extensions</code>，或者使用快捷键<code>Ctrl+Shift+X</code>。EverMonkey插件的作用是将vscode中的文件同步到印象笔记或者国际版Evernote。Auto-Open Markdown Preview插件的作用是在vscode中，当你打开*.md格式的文件时，自动开启预览，方便你在编辑的过程中实时的看到结果。<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/chenkang084/notes/master/imgs/blogs/vscode-1.png" alt="Auto-Open Markdown Preview 预览效果" title="">
                </div>
                <div class="image-caption">Auto-Open Markdown Preview 预览效果</div>
            </figure></p>
</blockquote>
<h3 id="3-EverMonkey配置说明。"><a href="#3-EverMonkey配置说明。" class="headerlink" title="3.EverMonkey配置说明。"></a>3.EverMonkey配置说明。</h3><p>EverMonkey插件是本文的<strong>重点</strong>，该插件主要负责将vscode中的文章同步到印象笔记。在vscode中安装完EverMonkey插件后，我们安装官方说明，来一步一步的配置。</p>
<ul>
<li>a.获取token、noteStoreUrl。快捷键<code>Ctrl+Shift+P</code>，打开command，输入<code>ever token</code>，这里我使用的是国际版Evernote，所以我选择的是International。</li>
<li>b.输入你的印象笔记的账号密码，然后授权，就可以看到<code>token、noteStoreUrl</code>。</li>
<li>c.将 <code>token、noteStoreUrl</code>配置到vscode的用户设置里面。步骤为<code>File --&gt; Preferences --&gt; Settings</code>，左边是系统默认设置，右边是用户自定义设置，在右侧配置token、noteStoreUrl，按照标准的json格式输入，key和value都需要加英文的双引号。<blockquote>
<p>evermonkey.token: your developer token<br><br>evermonkey.noteStoreUrl: your API url</p>
</blockquote>
</li>
<li>d.完成以上步骤，基本就算ok了，建议重启一下vscode，然后输入快捷键<code>Ctrl+Shift+P</code>打开command,输入<code>ever sync</code>，左下角显示synchronize successfully!(第一次同步可能有点慢，请耐心等待一下)，代表EverMonkey插件已经和印象笔记通信成功！如果报错，请去<a href="https://github.com/michalyao/evermonkey/issues" target="_blank" rel="noopener">git issue</a> 上面先找是否已经有人提过该问题，如果没有，你可以开个issue给作者。一般你遇到的问题，很多人也遇到了，请在close 里面仔细查找。</li>
<li>e.上传vscode本地文件。新建本地文件，后缀为.md。在文件内容的最上方输入一下内容。<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">  title: 文件名称</span><br><span class="line">  tags: 标签（多个标签用逗号分隔）</span><br><span class="line">  notebook: （所属的目录）</span><br><span class="line">---</span><br><span class="line"><span class="comment">//下面是正文内容</span></span><br><span class="line">...</span><br><span class="line">  # xxx</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>完成文章内容编写之后，输入<code>Ctrl+Shift+P</code>打开command,输入<code>ever publish</code>,提示成功后，就可以在印象笔记客户端看到文章加入到了指定的目录里（如果客户端没有自动更新，请尝试手动更新）,快速提交文章的快捷键是<code>Alt+P</code>。</p>
<blockquote>
<p>重要提示：如果报<code>Evernote Error: 5 - Note.title</code>，错误（这个错误坑了好一会）。说明是换行符有问题，请将vscode右下角的换行符从<code>CRLF</code>切换成<code>LF</code>,然后再次执行<code>ever publish</code>，就会有<code>blogs&gt;&gt;vscode中使用印象笔记 created successfully.</code>提示。如果还有错误，请到<a href="https://github.com/michalyao/evermonkey/issues" target="_blank" rel="noopener">git issue</a>查找相关问题。<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/chenkang084/notes/master/imgs/blogs/vscode-3.png" alt="Auto-Open Markdown Preview 预览效果" title="">
                </div>
                <div class="image-caption">Auto-Open Markdown Preview 预览效果</div>
            </figure></p>
</blockquote>
<h3 id="4-将Preview-设置为github风格"><a href="#4-将Preview-设置为github风格" class="headerlink" title="4.将Preview 设置为github风格"></a>4.将Preview 设置为github风格</h3><p>vscode 默认的将Preview预览风格是黑黑的，如上面的截图。如果想更改为github风格的样式，请执行如下步骤：</p>
<ul>
<li>a.下载github风格的<a href="https://github.com/raycon/vscode-markdown-css/blob/master/markdown-github.css" target="_blank" rel="noopener">css</a>到本地，并放置相应的目录，本文推荐放置在vscode安装目录里，如<code>D:/Program Files (x86)/Microsoft VS Code/resources/app/extensions/markdown/media/</code>。</li>
<li>b.设置用户配置文件,<code>File --&gt; Preferences --&gt; Settings</code>,添加如下配置信息，请填入你下载的css文件的<strong>路径</strong>和<strong>名称</strong>（我这里的文件名叫userStyle.css）。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;markdown.styles&quot;: [</span><br><span class="line">    &quot;file:///D:/Program Files (x86)/Microsoft VS Code/resources/app/extensions/markdown/media/userStyle.css&quot;</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/chenkang084/notes/master/imgs/blogs/vscode-4.png" alt="github 样式效果图" title="">
                </div>
                <div class="image-caption">github 样式效果图</div>
            </figure>
<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>马克飞象是一款非常好用的印象笔记插件，完全可以胜任以上所有功能，而且界面非常华丽，使用也很简单，但是，<strong>要收费。。。</strong> 之前用sublime的时候，就使用过相关插件，在sublime 里面实现编辑文章，同步到印象笔记。现在使用vscode比较多，就试试看有没有相关的功能，结果是肯定的（vscode这么优秀，怎能没有呢）。所以就尝试了一下，但是，遇到了个坑，就是<code>Evernote Error: 5 - Note.title</code>，查了半天说是<code>CRLF</code>切换成<code>LF</code>，我也确实在用户配置里面设置了，但是，就是不生效。最后，无意间发现，右下角显示的还是<code>CRLF</code>,然后尝试着点了一下，竟然可以改为<code>LF</code>,再然后呢，就没有然后了，OK了。<br></p>
<p>虽然费了一大会功夫，但是还是有收获的，就是，这个不要钱。。。<br></p>
<p>还有一个功能是马克飞象、印象笔记做不到的，印象笔记的内容保存在哪里我们并不知道，如果你想将这些内容同步到git上面，貌似是没有办法的。而使用vscode写*.md，文件内容都是在你指定的目录中，你可以随时将这些文件add,commit,push到git上面，是不是很方便。。。</p>
<blockquote>
<p>ps:这篇文章我就是用上述方法编辑的，非常方便，而且我直接push到我的<a href="https://github.com/chenkang084/notes/blob/master/blogs/vscode%E4%B8%AD%E4%BD%BF%E7%94%A8markdown.md" target="_blank" rel="noopener">git仓库了</a>。在git页面，直接复制该dom的html源码，贴到博客园就可以自动呈现格式化后的样子（虽然代码块、区域文本显示不太正常），还是很方便。<br><br>如果照片加载不全或者失败，可以直接访问本文<a href="https://github.com/chenkang084/notes/blob/master/blogs/vscode%E4%B8%AD%E4%BD%BF%E7%94%A8markdown.md" target="_blank" rel="noopener">git页面</a>。</p>
</blockquote>

    

        <a href="/2017/08/01/mark-down-for-vscode/" class="post-more waves-effect waves-button">
            post.continue_reading
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Markdown/">Markdown</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vscode/">vscode</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-HowToBuildAWebSite"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2017-07-24 19:51:15" datetime="2017-07-24T11:51:15.000Z"  itemprop="datePublished">2017-07-24</time>

        


    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/2017/07/24/HowToBuildAWebSite/">我是如何搭建起这个网站的</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <blockquote>
<p>本文只是做个记录  </p>
</blockquote>
<h1 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h1><h2 id="域名"><a href="#域名" class="headerlink" title="域名"></a>域名</h2><blockquote>
<p>域名（Domain Name），是由一串用点分隔的字符组成的Internet上某一台计算机或计算机组的名称，用于在数据传输时标识计算机的电子方位（有时也指地理位置，地理上的域名，指代有行政自主权的一个地方区域）。域名是一个IP地址上有“面具” 。一个域名的目的是便于记忆和沟通的一组服务器的地址（网站，电子邮件，FTP等）。  </p>
</blockquote>
<p>这个博客使用的域名为(blog.yanximin.site)是从阿里云上直接购买得到. 第一年四块钱(很实惠有没有), 但是今年就已经变成了40块钱(坑…).  </p>
<h2 id="VPS"><a href="#VPS" class="headerlink" title="VPS"></a>VPS</h2><blockquote>
<p>VPS（Virtual Private Server 虚拟专用服务器）技术，将一台服务器分割成多个虚拟专享服务器的优质服务。实现VPS的技术分为容器[1]  技术，和虚拟化技术[2]  。在容器或虚拟机中，每个VPS都可分配独立公网IP地址、独立操作系统、实现不同VPS间磁盘空间、内存、CPU资源、进程和系统配置的隔离，为用户和应用程序模拟出“独占”使用计算资源的体验。VPS可以像独立服务器一样，重装操作系统，安装程序，单独重启服务器。VPS为使用者提供了管理配置的自由，可用于企业虚拟化，也可以用于IDC资源租用。  </p>
</blockquote>
<p>VPS服务器是在<a href="http://bandwagonhost.com/" title="搬瓦工" target="_blank" rel="noopener">搬瓦工</a>上购买,一个月十块钱(1000G流量,10G硬盘). 当服务器的同时,还能顺便FQ,可以说相当划算. VPS上直接使用Bandwagon提供的镜像,安装了CentOS 6. 顺便说一下,他们家的VPS提供了安装ShawdowSocks的脚本,一键安装,十分方便.</p>
<h1 id="博客搭建"><a href="#博客搭建" class="headerlink" title="博客搭建"></a>博客搭建</h1><h2 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h2><p>本博客使用<a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>框架搭建的.除此之外,使用了<a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank" rel="noopener">indigo</a> 作为网站的前端模板.  </p>
<blockquote>
<p>Hexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</p>
</blockquote>
<p>而inidigo模板主要有以下的特色  </p>
<blockquote>
<ol>
<li>仅支持 IE10+ 等现代浏览器。 </li>
<li>去 jQuery，更轻。相信现代浏览器的原生兼容性。 </li>
<li>使用 Less 作为 css 预处理器，需要安装 <code>hexo-renderer-less</code>。 </li>
<li>添加了英文字体支持 Roboto。 </li>
<li>添加了一些波纹效果。By <a href="https://github.com/fians/Waves" target="_blank" rel="noopener">Waves</a> </li>
<li>无前端依赖的分享实现。 </li>
<li>基于静态数据的站内搜索，无第三方侵入。 </li>
<li>支持文章打赏。 </li>
</ol>
</blockquote>
<h2 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h2><p>目前,网站通过Hexo生成静态页面,部署在Nginx上.(之前部署在Apache上面,但是存在着一些性能和权限的问题).</p>
<p>使用如下的脚本在Cent OS上安装Nginx</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin</span><br><span class="line">export PATH</span><br><span class="line"><span class="meta">#</span>安装依赖环境</span><br><span class="line">yum install -y patch openssl make cmake gcc gcc-c++ gcc-g77 flex bison file libtool libtool-libs autoconf kernel-devel libjpeg libjpeg-devel libpng libpng-devel libpng10 libpng10-devel gd gd-devel freetype freetype-devel libxml2 libxml2-devel zlib zlib-devel glib2 glib2-devel bzip2 bzip2-devel libevent libevent-devel ncurses ncurses-devel curl curl-devel e2fsprogs e2fsprogs-devel krb5 krb5-devel libidn libidn-devel openssl openssl-devel vim-minimal nano fonts-chinese gettext gettext-devel ncurses-devel gmp-devel pspell-devel unzip libcap diffutils</span><br><span class="line"><span class="meta">#</span>安装PCRE</span><br><span class="line">wget http://downloads.sourceforge.net/project/pcre/pcre/8.36/pcre-8.36.tar.gz</span><br><span class="line">tar zxf pcre-8.36.tar.gz</span><br><span class="line">cd pcre-8.36/</span><br><span class="line">./configure &amp;&amp; make &amp;&amp; make install</span><br><span class="line">cd ../</span><br><span class="line"><span class="meta">#</span>安装NGINX</span><br><span class="line">wget http://nginx.org/download/nginx-1.6.3.tar.gz</span><br><span class="line">tar zxf nginx-1.6.3.tar.gz</span><br><span class="line">cd nginx-1.6.3/</span><br><span class="line">./configure --user=nobody --group=nobody --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-http_gzip_static_module --with-ipv6 --with-http_sub_module --with-http_spdy_module</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line">cd ../</span><br><span class="line"></span><br><span class="line">ln -s /usr/local/lib/libpcre.so.1 /lib</span><br><span class="line">ln -s /usr/local/nginx/sbin/nginx /usr/bin/nginx</span><br><span class="line">rm -f /usr/local/nginx/conf/nginx.conf</span><br><span class="line">mkdir -p /home/wwwroot/default</span><br><span class="line">chmod +w /home/wwwroot/default</span><br><span class="line">mkdir -p /home/wwwlogs</span><br><span class="line">chmod 777 /home/wwwlogs</span><br><span class="line">chown -R nobody:nobody /home/wwwroot/default</span><br><span class="line"></span><br><span class="line">wget -c http://soft.vpser.net/lnmp/ext/init.d.nginx</span><br><span class="line">cp init.d.nginx /etc/init.d/nginx</span><br><span class="line">chmod +x /etc/init.d/nginx</span><br><span class="line">chkconfig --level 345 nginx on</span><br><span class="line">/sbin/iptables -I INPUT -p tcp --dport 80 -j ACCEPT</span><br><span class="line">/sbin/iptables-save</span><br><span class="line">ldconfig</span><br><span class="line">wget -c http://redbook.qiniudn.com/nginx.conf</span><br><span class="line">mv nginx.conf /usr/local/nginx/conf/</span><br><span class="line">/etc/init.d/nginx start</span><br></pre></td></tr></table></figure>
<p>执行完上述脚本之后，还得修改<code>/usr/local/nginx/conf/nginx.conf</code>文件，修改结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">user  root;</span><br><span class="line"></span><br><span class="line">worker_processes auto;</span><br><span class="line"></span><br><span class="line">error_log  /home/wwwlogs/nginx_error.log  crit;</span><br><span class="line"></span><br><span class="line">pid   /usr/local/nginx/logs/nginx.pid;</span><br><span class="line"></span><br><span class="line">worker_rlimit_nofile 51200;</span><br><span class="line"></span><br><span class="line">events</span><br><span class="line">        &#123;</span><br><span class="line">                use epoll;</span><br><span class="line">                worker_connections 51200;</span><br><span class="line">                multi_accept on;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">http</span><br><span class="line">        &#123;</span><br><span class="line">                include       mime.types;</span><br><span class="line">                default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">                server_names_hash_bucket_size 128;</span><br><span class="line">                client_header_buffer_size 32k;</span><br><span class="line">                large_client_header_buffers 4 32k;</span><br><span class="line">                client_max_body_size 50m;</span><br><span class="line"></span><br><span class="line">                sendfile on;</span><br><span class="line">                tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">                keepalive_timeout 60;</span><br><span class="line"></span><br><span class="line">                tcp_nodelay on;</span><br><span class="line"></span><br><span class="line">                gzip             on;</span><br><span class="line">                gzip_comp_level  4;</span><br><span class="line">                gzip_min_length  1k;</span><br><span class="line">                gzip_buffers     4 16k;</span><br><span class="line">                gzip_proxied     any;</span><br><span class="line">                gzip_types       text/plain application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;</span><br><span class="line"></span><br><span class="line">                server_tokens off;</span><br><span class="line"></span><br><span class="line">                fastcgi_connect_timeout 300;</span><br><span class="line">                fastcgi_send_timeout 300;</span><br><span class="line">                fastcgi_read_timeout 300;</span><br><span class="line">                fastcgi_buffer_size 64k;</span><br><span class="line">                fastcgi_buffers 4 64k;</span><br><span class="line">                fastcgi_busy_buffers_size 128k;</span><br><span class="line">                fastcgi_temp_file_write_size 256k;</span><br><span class="line"></span><br><span class="line">                proxy_connect_timeout      5;</span><br><span class="line">                proxy_read_timeout         60;</span><br><span class="line">                proxy_send_timeout         5;</span><br><span class="line">                proxy_buffer_size          16k;</span><br><span class="line">                proxy_buffers              4 64k;</span><br><span class="line">                proxy_busy_buffers_size    128k;</span><br><span class="line">                proxy_temp_file_write_size 128k;</span><br><span class="line"></span><br><span class="line">                 log_format  access  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class="line">                &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class="line">             &apos;&quot;$http_user_agent&quot; $http_x_forwarded_for&apos;;</span><br><span class="line"></span><br><span class="line">server</span><br><span class="line">        &#123;</span><br><span class="line">                listen 80 default;</span><br><span class="line">                #listen [::]:80 default ipv6only=on;</span><br><span class="line">                server_name since1989.org geek.wasai.org;</span><br><span class="line">                index index.html index.htm index.php;</span><br><span class="line">                root  /root/hexo/public;</span><br><span class="line"></span><br><span class="line">                #error_page   404   /404.html;</span><br><span class="line">                location ~ [^/]\.php(/|$)</span><br><span class="line">                        &#123;</span><br><span class="line">                                # comment try_files $uri =404; to enable pathinfo</span><br><span class="line">                                try_files $uri =404;</span><br><span class="line">                                fastcgi_pass  unix:/tmp/php-cgi.sock;</span><br><span class="line">                                fastcgi_index index.php;</span><br><span class="line">                                include fastcgi.conf;</span><br><span class="line">                                #include pathinfo.conf;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                location /nginx_status &#123;</span><br><span class="line">                        stub_status on;</span><br><span class="line">                        access_log   off;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$</span><br><span class="line">                        &#123;</span><br><span class="line">                                expires      30d;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                location ~ .*\.(js|css)?$</span><br><span class="line">                        &#123;</span><br><span class="line">                                expires      12h;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                access_log  /home/wwwlogs/access.log  access;</span><br><span class="line">        &#125;</span><br><span class="line">include vhost/*.conf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重启Nginx之后，我们的博客服务就可以完美地运行了</p>

    

        <a href="/2017/07/24/HowToBuildAWebSite/" class="post-more waves-effect waves-button">
            post.continue_reading
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网站维护/">网站维护</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-WebMagic"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2017-07-24 17:28:47" datetime="2017-07-24T09:28:47.000Z"  itemprop="datePublished">2017-07-24</time>

        


    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/2017/07/24/WebMagic/">使用WebMagic定制爬虫</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h1 id="使用WebMagic定制爬虫"><a href="#使用WebMagic定制爬虫" class="headerlink" title="使用WebMagic定制爬虫"></a>使用WebMagic定制爬虫</h1><hr>
<p><a href="http://webmagic.io/" target="_blank" rel="noopener">WebMagic</a>是一个简单灵活的Java爬虫框架。基于WebMagic，你可以快速开发出一个高效、易维护的爬虫。 </p>
<p>WebMagic的总体架构如下图所示<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://code4craft.github.io/images/posts/webmagic.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>  </p>
<p><strong>Downloader</strong></p>
<p>Downloader负责从互联网上下载页面，以便后续处理。WebMagic默认使用了Apache HttpClient作为下载工具。</p>
<p><strong>PageProcessor</strong></p>
<p>PageProcessor负责解析页面，抽取有用信息，以及发现新的链接。WebMagic使用Jsoup作为HTML解析工具，并基于其开发了解析XPath的工具Xsoup。</p>
<p>在这四个组件中，PageProcessor对于每个站点每个页面都不一样，是需要使用者定制的部分。</p>
<p><strong>Scheduler</strong></p>
<p>Scheduler负责管理待抓取的URL，以及一些去重的工作。WebMagic默认提供了JDK的内存队列来管理URL，并用集合来进行去重。也支持使用Redis进行分布式管理。</p>
<p>除非项目有一些特殊的分布式需求，否则无需自己定制Scheduler。</p>
<p><strong>Pipeline</strong></p>
<p>Pipeline负责抽取结果的处理，包括计算、持久化到文件、数据库等。WebMagic默认提供了“输出到控制台”和“保存到文件”两种结果处理方案。</p>
<p>Pipeline定义了结果保存的方式，如果你要保存到指定数据库，则需要编写对应的<code>Pipeline</code>。对于一类需求一般只需编写一个<code>Pipeline</code>。</p>
<p>根据WebMagic的文档我们能够很快写出一个爬虫。比如下面就是一个爬取糗事百科的简单爬虫Demo<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.Page;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.Site;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.Spider;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.pipeline.ConsolePipeline;</span><br><span class="line"><span class="keyword">import</span> us.codecraft.webmagic.processor.PageProcessor;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QSBKPageProcesser</span> <span class="keyword">implements</span> <span class="title">PageProcessor</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Site site = Site.me()</span><br><span class="line">			.addHeader(<span class="string">"User-Agent"</span>, <span class="string">"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1) QQBrowser/6.0"</span>)</span><br><span class="line">			.setDomain(<span class="string">"www.qiushibaike.com"</span>).setTimeOut(<span class="number">5000</span>).setRetryTimes(<span class="number">5</span>);</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(Page page)</span> </span>&#123;</span><br><span class="line">		String url = page.getUrl().toString();</span><br><span class="line">		<span class="keyword">if</span>(url.contains(<span class="string">"article"</span>))&#123;</span><br><span class="line">			<span class="comment">//解析内容界面</span></span><br><span class="line">			System.out.println(page.getHtml().xpath(<span class="string">"//div[@class='content']/text()"</span>).toString());</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="comment">//解析列表界面</span></span><br><span class="line">			List&lt;String&gt; list = page.getHtml().xpath(<span class="string">"//a[@class='contentHerf']/@href"</span>).all();</span><br><span class="line">			page.addTargetRequests(list);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Site <span class="title">getSite</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.site;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		Spider spider = Spider.create(<span class="keyword">new</span> QSBKPageProcesser()).addPipeline(<span class="keyword">new</span> ConsolePipeline());</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">9</span>;i++)&#123;</span><br><span class="line">			spider.addUrl(<span class="string">"https://www.qiushibaike.com/8hr/page/"</span>+i+<span class="string">"/?s=4996915"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		spider.run();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>最后爬虫的输出结果如下  </p>
<pre><code>get page: https://www.qiushibaike.com/8hr/page/1/?s=4996915
get page: https://www.qiushibaike.com/8hr/page/2/?s=4996915
get page: https://www.qiushibaike.com/8hr/page/3/?s=4996915
get page: https://www.qiushibaike.com/8hr/page/4/?s=4996915
get page: https://www.qiushibaike.com/8hr/page/5/?s=4996915
get page: https://www.qiushibaike.com/8hr/page/6/?s=4996915
get page: https://www.qiushibaike.com/8hr/page/7/?s=4996915
get page: https://www.qiushibaike.com/8hr/page/8/?s=4996915
 那天去海边游泳，有一位大哥穿着上衣游，我不禁问他：“大哥，为什么你不光膀子游，衣服贴在身上多难受！”大哥脱了上衣给我看，身体上面有文胸的白色?迹。我正惊疑不定，大哥抹了一把脸说：“我前天撩起背心晒日光浴，没想到晒成这样，怪我没经验.....” 
get page: https://www.qiushibaike.com/article/119336220
 小学放假的一天，爸爸让我在家好好写作业，怕我偷看电视，就把总闸拉下来，去地里干活了。但是，架不住我聪明啊。等他们走了，我自己偷偷的合上闸看电视。为了怕他们发现电视后壳发热，我提前一段时间就关了电视。可是，那顿打我还是没有逃过去，我忘了电表是会动的！ 
get page: https://www.qiushibaike.com/article/119337633
 三个宿舍舍友出去聚餐，十一个人正好一桌，结账的时候约好大家各人掏出一张银行卡给服务员抽一张刷，服务员抽到第四张余额不足的时候终于发飙了 
get page: https://www.qiushibaike.com/article/119337499
 嫂子炸乎乎的打来电话：你哥摊上大事了！被人给告了！我一惊，忙安慰她：别着急，有话好好说，啥事谁告的？她：你八岁的大侄子告的呀，揍了他一顿，就跑到街头派.出所告你哥虐待儿童，你哥正在所里接受教育呢…… 
get page: https://www.qiushibaike.com/article/119337859
 LZ农村的割…… 小时候和老妈 我弟一起去上山砍柴，砍累了就坐在树下乘凉 ，我弟就趴树上去摇树枝玩，突然…… 树上掉下一条蛇落在我头上，当时我和蛇都惊呆了……呆了……了 
get page: https://www.qiushibaike.com/article/119335791
 在家无聊，想去看个电影，到电影院买票，一张45，给了售票员一张一百，她居然找我10块，我手里拿着钱，和售票员对视五秒后…她用非常惊讶的表情问我：你一个人看电影？ …靠 有谁规定看电影必须两个人么！ 你妹的 
get page: https://www.qiushibaike.com/article/119336589
 爷爷年轻的时候脾气比较暴躁，喝醉酒就打奶奶，奶奶一直忍气吞声的过日子。现在儿女都在外面安家落户，70多岁的爷爷还是跟奶奶生活在老家，不愿意来城里跟我们一起住。昨晚爷爷又打电话过来：儿子啊，你快管管你娘吧，这个星期已经揍了我三回，我现在打不过他啊。 
get page: https://www.qiushibaike.com/article/119337603
</code></pre><p>可见，使用WebMagic构建一个爬虫是十分便捷的，不逊色于Python的Scrapy。:)</p>

    

        <a href="/2017/07/24/WebMagic/" class="post-more waves-effect waves-button">
            post.continue_reading
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WebMagic/">WebMagic</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/爬虫/">爬虫</a></li></ul>

    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-three-tools-for-jvm"
  class="article-card article-type-post" itemprop="blogPost">

    <div class="post-meta">
        <time class="post-time" title="2017-06-30 10:32:18" datetime="2017-06-30T02:32:18.000Z"  itemprop="datePublished">2017-06-30</time>

        


    </div>

    


  
    <h3 class="post-title" itemprop="name">
      <a class="post-title-link" href="/2017/06/30/three-tools-for-jvm/">三个方便查看JVM信息的工具</a>
    </h3>
  




    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h2 id="1-JPS"><a href="#1-JPS" class="headerlink" title="1 JPS"></a>1 JPS</h2><p>JPS是jdk提供的一个查看当前Java进程的小工具， 可以看做是JavaVirtual Machine Process Status Tool的缩写。<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://ww1.sinaimg.cn/large/a1ee729cly1fi3fmpmbqhj20i304mq3j.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>比方说上图，有两个Java进程，分别为Eclipse和JPS本身。</p>
<h2 id="2-JSTACK"><a href="#2-JSTACK" class="headerlink" title="2 JSTACK"></a>2 JSTACK</h2><p>jstack用于打印出给定的java进程ID或core file或远程调试服务的Java堆栈信息。<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://ww1.sinaimg.cn/large/a1ee729cly1fi3fo2cw07j20as022a9u.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://ww1.sinaimg.cn/large/a1ee729cly1fi3fp59n9ej20x80oxdi4.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><br>使用Jstack可以很方便地查看死锁，以及出处。<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://ww1.sinaimg.cn/large/a1ee729cly1fi3fqbuvjtj210l0lewgj.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></p>
<h2 id="3-JVISUALVM"><a href="#3-JVISUALVM" class="headerlink" title="3 JVISUALVM"></a>3 JVISUALVM</h2><p>一个功能强大的JVM可视化工具</p>
<ul>
<li>查看概况<br><img src="http://ww1.sinaimg.cn/large/a1ee729cly1fi3fryy1v7j20ps0dnjs5.jpg" alt=""></li>
<li>查看资源使用概况<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://ww1.sinaimg.cn/large/a1ee729cly1fi3fsy2cdtj20hz0dqmxn.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure></li>
<li>查看内存使用情况和GC<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://ww1.sinaimg.cn/large/a1ee729cly1fi3fu7w132j20hz0ewdgb.jpg" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
还有其他很多功能</li>
</ul>

    

        <a href="/2017/06/30/three-tools-for-jvm/" class="post-more waves-effect waves-button">
            post.continue_reading
        </a>
    </div>
    
    <div class="post-footer">
        
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </div>
    
</article>

        </li>
    
    </ul>

    
<nav id="page-nav">
    <div class="inner">
    <a class="extend prev" rel="prev" href="/">上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">下一页</a>
    </div>
</nav>


</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>版权所有</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>Yan Ximin &copy; 2015 - 2018</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.yanximin.site/page/2/&title=无名小站&pic=http://blog.yanximin.site/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.yanximin.site/page/2/&title=无名小站&source=随便记录点东西" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.yanximin.site/page/2/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=无名小站&url=http://blog.yanximin.site/page/2/&via=http://blog.yanximin.site" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.yanximin.site/page/2/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAAB00lEQVR42u3ay24CMQwFUP7/p6fbVtWEa+cxIJ2sqgLDCQsrvs7rFa/r1xq/eveeu0+9dixcXNxp7jVcCegK1n/i+Pm3m8fFxT3IHReau0eP/9N7/xsbLi7uB3OrBSgvari4uN/InelTqs/HxcV9ljvftKzNMRb0ari4uBPcari54+8t+S4uLm6LexVXMmLJy1z523FxcY9w84KSBx+9yLUw3MXFxd3Mnb9UkSCS8DT6Xlxc3Ie4vUblaq3yBQ5cXNwj3LyZmRmaVp+QX87AxcU9w00OJdVi1BuuFNokXFzcDdzFx47gYkdvVIOLi3uGOz6I5NcjmkltbPjTq+Hi4m7mzlyfysPQmYgkqr64uLjbuNXxSbUA9TZQCExxcXGXcvPmZ3ezFLVPuLi4B7njw0T1KFMdtxQuauDi4h7nJkORZEu9cWn0KVxc3Ie41eFrfhGzeaxZ9SBcXNzgnVdx9aKTPByJ9oGLi7uZW40n8sNKUpjyY1N5M7i4uNPcvHj14tRqIPvmVVxc3IPcvNDMXNRIyt+bIBUXF/cjub0mqtd0LT4x4eLibubOBCW9gS4uLu55bjUkzePOfDPRj4WLi3uEOz+nzQcneVu1IN/FxcXtcH8A06AgHlMiuT0AAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="/js/main.min.js?v=1.6.10"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.6.10" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
